# –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –±–æ—Ç–∞.

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–µ Python-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

*   **Runtime:** Python 3.8+
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite (—Ñ–∞–π–ª `jobs_database.db`). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–∞–∫–∞–Ω—Å–∏–π, –æ—Ç–∫–ª–∏–∫–æ–≤ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM.
*   **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker.

### –°—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã
1.  –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ë–î (–ø—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏).
2.  –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å Telegram (Long Polling).
3.  –ó–∞–ø—É—Å–∫–∞–µ—Ç HTTP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –º–µ—Ç—Ä–∏–∫ (–ø–æ—Ä—Ç 8000).
4.  –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ GIL, –Ω–æ `telebot` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–µ–¥–∏–Ω–≥).

## üê≥ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ (Docker)

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Docker.

–î–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `docker compose` (V2) –∏–ª–∏ `docker-compose` (V1).

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `docker-compose.yml`
```yaml
version: '3.8'
services:
  bot:
    build: .
    restart: always
    env_file: .env
    volumes:
      - ./jobs_database.db:/app/jobs_database.db  # –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ë–î
      - ./backups:/app/backups                    # –ü–∞–ø–∫–∞ –¥–ª—è –±—ç–∫–∞–ø–æ–≤
      - ./bot.json.log:/app/bot.json.log          # –õ–æ–≥–∏
    ports:
      - "8000:8000"                               # –ú–µ—Ç—Ä–∏–∫–∏
```

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–µ–ø–ª–æ—è
```bash
# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker compose up -d --build

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker compose logs -f

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose down
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `TELEGRAM_BOT_TOKEN` | –î–∞ | –¢–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç @BotFather |
| `ADMIN_IDS` | –î–∞ | –°–ø–∏—Å–æ–∫ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä. `123,456`) |
| `SENTRY_DSN` | –ù–µ—Ç | DSN –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Sentry |
| `PROMETHEUS_PORT` | –ù–µ—Ç | –ü–æ—Ä—Ç –¥–ª—è –º–µ—Ç—Ä–∏–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8000) |

## üîÑ CI/CD (GitHub Actions)

–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω workflow `.github/workflows/ci.yml`.

### –≠—Ç–∞–ø—ã (Jobs):
1.  **Build & Test:**
    *   –ó–∞–ø—É—Å–∫ –Ω–∞ Python 3.8, 3.9, 3.10.
    *   –õ–∏–Ω—Ç–∏–Ω–≥ (`flake8`).
    *   –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (`bandit`).
    *   –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (`pytest`) —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–∫—Ä—ã—Ç–∏—è.

        *   –ü–æ–∫—Ä—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 80%.
2.  **Deploy:**
    *   –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É `main`.
    *   –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH.
    *   –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–¥ (`git pull`).
    *   –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

## üíæ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite —Ñ–∞–π–ª `jobs_database.db`.
*   **–ú–µ—Ö–∞–Ω–∏–∑–º:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `/backup` (–¥–æ—Å—Ç—É–ø–Ω–∞ –∞–¥–º–∏–Ω–∞–º) —Å–æ–∑–¥–∞–µ—Ç –∫–æ–ø–∏—é –ë–î –≤ –ø–∞–ø–∫—É `backups/` –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª –≤ —á–∞—Ç.
*   **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ `jobs_database.db` —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ —Ö–æ—Å—Ç-—Å–∏—Å—Ç–µ–º—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, cron + rsync).

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å—Ç–µ–∫: **Prometheus + Grafana**.
1.  –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Prometheus –Ω–∞ —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫ —Å –ø–æ—Ä—Ç–∞ 8000.
2.  –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ –≤ Grafana –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ RPS, –æ—à–∏–±–æ–∫ –∏ –∑–∞–¥–µ—Ä–∂–µ–∫.
